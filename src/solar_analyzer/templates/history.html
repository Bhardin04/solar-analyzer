{% extends "base.html" %}

{% block title %}Historical Data - Solar Analyzer{% endblock %}

{% block content %}
<div class="row mb-4">
    <div class="col-12">
        <h2><i class="fas fa-chart-line"></i> Historical Data</h2>
        <p class="text-muted">Analyze your solar system performance over time</p>
    </div>
</div>

<!-- Date Range Selector -->
<div class="row mb-4">
    <div class="col-12">
        <div class="card">
            <div class="card-body">
                <form id="date-range-form" class="row g-3">
                    <div class="col-md-3">
                        <label for="start-date" class="form-label">Start Date</label>
                        <input type="date" class="form-control" id="start-date" required>
                    </div>
                    <div class="col-md-3">
                        <label for="end-date" class="form-label">End Date</label>
                        <input type="date" class="form-control" id="end-date" required>
                    </div>
                    <div class="col-md-3">
                        <label for="interval" class="form-label">Interval</label>
                        <select class="form-select" id="interval">
                            <option value="hour">Hourly</option>
                            <option value="day" selected>Daily</option>
                            <option value="week">Weekly</option>
                            <option value="month">Monthly</option>
                        </select>
                    </div>
                    <div class="col-md-3">
                        <label class="form-label">&nbsp;</label>
                        <button type="submit" class="btn btn-primary w-100">
                            <i class="fas fa-sync"></i> Update
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Summary Statistics -->
<div class="row mb-4">
    <div class="col-md-3">
        <div class="card text-white bg-success">
            <div class="card-body">
                <h6 class="card-title">Total Production</h6>
                <h3 id="total-production">-- kWh</h3>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card text-white bg-info">
            <div class="card-body">
                <h6 class="card-title">Total Consumption</h6>
                <h3 id="total-consumption">-- kWh</h3>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card text-white bg-warning">
            <div class="card-body">
                <h6 class="card-title">Net Energy</h6>
                <h3 id="net-energy">-- kWh</h3>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card text-white bg-primary">
            <div class="card-body">
                <h6 class="card-title">Self-Consumption</h6>
                <h3 id="self-consumption">-- %</h3>
            </div>
        </div>
    </div>
</div>

<!-- Historical Charts -->
<div class="row mb-4">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <ul class="nav nav-tabs card-header-tabs" role="tablist">
                    <li class="nav-item">
                        <a class="nav-link active" data-bs-toggle="tab" href="#production-tab">Production</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" data-bs-toggle="tab" href="#consumption-tab">Consumption</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" data-bs-toggle="tab" href="#grid-tab">Grid Exchange</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" data-bs-toggle="tab" href="#comparison-tab">Comparison</a>
                    </li>
                </ul>
            </div>
            <div class="card-body">
                <div class="tab-content">
                    <div class="tab-pane fade show active" id="production-tab">
                        <canvas id="production-history-chart"></canvas>
                    </div>
                    <div class="tab-pane fade" id="consumption-tab">
                        <canvas id="consumption-history-chart"></canvas>
                    </div>
                    <div class="tab-pane fade" id="grid-tab">
                        <canvas id="grid-history-chart"></canvas>
                    </div>
                    <div class="tab-pane fade" id="comparison-tab">
                        <canvas id="comparison-chart"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Data Export -->
<div class="row">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">Export Data</h5>
            </div>
            <div class="card-body">
                <p>Export your solar data for external analysis</p>
                <button class="btn btn-outline-primary" id="export-csv">
                    <i class="fas fa-file-csv"></i> Export as CSV
                </button>
                <button class="btn btn-outline-secondary" id="export-json">
                    <i class="fas fa-file-code"></i> Export as JSON
                </button>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script src="/static/js/history.js"></script>
{% endblock %}